\documentclass[letterpaper]{article}
\input{../../../preamble.tex}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{fancyhdr}
\usepackage[hidelinks]{hyperref}

\pagestyle{fancy}
\fancyhf{}
\rhead{CSE 158R}
\chead{Thursday, September 22, 2022}
\lhead{Lecture 1}
\rfoot{\thepage}

\setlength{\parindent}{0pt}

\begin{document}

\section{Introduction to Data Mining}
In this course, we will focus on \textbf{Web Mining and Recommender Systems}. We will build models to help us understand data in order to gain insights and make predictions.

\begin{mdframed}[]
    (Example.) Recommender System. 
    \begin{itemize}
        \item \textbf{Prediction:} What (star-) rating will a person give to a product? For example, \code{rating("julian", "Pitch Black")}.
        \begin{itemize}
            \item If we can solve a prediction task, then we can build things like a recommender system. For example, if we can predict what stars you will give to a particular movie, we can suggest those movies to that user.
        \end{itemize}
        \item \textbf{Application:} Build a system to recommend products that people are interested in. 
        \begin{itemize}
            \item Would this person like this movie? 
        \end{itemize}
        \item \textbf{Insights:} How are opinions influenced by factors like time, gender, age, and location?
    \end{itemize}
\end{mdframed}

\begin{mdframed}[]
    (Example.) Social Networks.
    \begin{itemize}
        \item \textbf{Prediction:} Whether two users of a social network are likely to be friends.
        \item \textbf{Application:} Friend recommendation features. 
        \begin{itemize}
            \item Does this person know the other person? (e.g., ``people you may know'').
        \end{itemize}
        \item \textbf{Insights:} What are the features around which friendships form? 
        \begin{itemize}
            \item Do you become friends because you have some feature in common (e.g., same group)? 
        \end{itemize}
    \end{itemize}
\end{mdframed}

\begin{mdframed}[]
    (Example.) Advertising. 
    \begin{itemize}
        \item \textbf{Prediction:} Will I click on an advertisement? 
        \item \textbf{Application:} Recommend relevant (or likely to be clicked on) advertisements to maximize revenue.
        \begin{itemize}
            \item Google! 
        \end{itemize}
        \item \textbf{Insights:} What products tend to be purchased together? What do people purchase at different times of the year?  
    \end{itemize}
\end{mdframed}

\begin{mdframed}[]
    (Example.) Medical Informatics.
    \begin{itemize}
        \item \textbf{Prediction:} What symptoms will a person exhibit on their next visit to the doctor? 
        \item \textbf{Application:} Recommend preventative treatment. 
        \item \textbf{Insights:} How do diseases progress? How do different people progress through those stages? 
    \end{itemize}
\end{mdframed}

\subsection{Requirements for Data Mining}
What do we need to do data mining? 
\begin{enumerate}
    \item Are the data associated with meaningful outcomes? 
    \begin{itemize}
        \item Are the data \textbf{labeled}?
        \item Are the instances (relatively) independent? 
    \end{itemize}

    \begin{mdframed}[]
        (Example.) If we're trying to build a recommender system to predict ratings (e.g., who likes this movie?), then the \textbf{label} would be the rating that we're trying to track.
        
        \bigskip 

        However, if we're trying to predict which reviews are sarcastic, then there are no labels -- it's not possible to objectively identify sarcastic reviews.
    \end{mdframed}

    \item Is there a clear objective to be optimized? 
    \begin{itemize}
        \item How will we know if we've modeled the data well? 
        \item Can actions be taken based on our findings? 
    \end{itemize}

    \begin{mdframed}[]
        (Example.) Who likes this movie? How wrong were our predictions on average? 
    \end{mdframed}

    \item Is there enough data? 
    \begin{itemize}
        \item Are our results statistically significant? 
        \item Can features be collected?
        \item Are the features useful/relevant/predictive?
    \end{itemize}
\end{enumerate}


\newpage 
\section{Machine Learning Basics}
In this section, we'll talk a bit more about the basics of machine learning. 

\subsection{Supervised Learning}
\begin{definition}{Supervised Learning}{}
    \textbf{Supervised Learning} is the process of trying to infer from labeled data the underlying function that produced the labels associated with the data. 
\end{definition}
More abstractly, given \textbf{labeled training data} of the form 
\[\{(\text{data}_1, \text{label}_1), \ldots, (\text{data}_n, \text{label}_n)\},\]
we want to estimate the function 
\[f(\text{data}) \mapsto \text{labels}.\]
In other words, given the data, can we predict what the label will be? Can we figure out what form this function should take? 

\begin{mdframed}[]
    (Example.) Suppose we want to build a movie recommender, e.g., given a list of films, which of these films will I rate the highest?
    \begin{itemize}
        \item The \textbf{labels} here would be the \textbf{ratings} that others have given to each movie, and that I have given to other movies in the past. So, we have this huge collection of data consisting of movie ratings.
        \item The \textbf{data} here would be the \textbf{features} about the movie and the users who evaluated it. Essentially, the features we care to extract, anything that we think may help us predict the rating. For example:
        \begin{itemize}
            \item Movie Features: genre, actors, MPAA rating, length, etc.
            \item User Features: age, gender, location, etc. 
        \end{itemize}
    \end{itemize}
    Can we build our first supervised machine learning (or regression) model for this example? Specifically, can we estimate a star rating given the features associated with a user and the features associated with a movie? 
    \[f(\text{user features, movie features}) \overset{?}{\mapsto} \text{star rating}.\]
    There are several solutions that we may try. 
    \begin{enumerate}
        \item Design a system based on prior knowledge.\begin{verbatim}
    def prediction(user, movie):
        if user['age'] < 14:
            if movie['mpaa_rating'] == 'G':
                return 5.0
            else 
                return 1.0
        else if user['age'] <= 18:
            if movie['mpaa_rating'] == 'PG':
                return 5.0
        ...\end{verbatim}
        
        \begin{mdframed}[]
            Disadvantages:
            \begin{itemize}
                \item Depends on possibly false assumptions about how users relate to items. 
                \item Cannot adapt to new data/information (e.g., books).
            \end{itemize}
            Advantages:
            \begin{itemize}
                \item Requires no data!
            \end{itemize}
            Basically, hardcoding is bad for this example.
        \end{mdframed}
        \item We can identify words that were frequently mentioned in social media posts, and recommend movie whose plot synopses use similar types of language. 
        
        \begin{mdframed}[]
            Disadvantages:
            \begin{itemize}
                \item Depends on possibly false assumptions about how users relate to items. 
                \item May not be adaptable to new settings. 
            \end{itemize}
            Advantages:
            \begin{itemize}
                \item Requires data, but does not required \emph{labeled} data. 
            \end{itemize}
        \end{mdframed}
        \item Identify which attributes (e.g., actors, genres) are associated with positive ratings. Recommend movies that exhibit those attributes.
        
        \begin{mdframed}[]
            Disadvantages:
            \begin{itemize}
                \item Requires a (possibly large) dataset of movies with labeled ratings. 
            \end{itemize}
            Advantages:
            \begin{itemize}
                \item Directly optimizes a measure we care about (predicting ratings).
                \item Easy to adapt to new settings and data. 
            \end{itemize}
        \end{mdframed}
    \end{enumerate}
\end{mdframed}

\subsection{Supervised vs. Unsupervised Learning}
\textbf{Learning} approaches attempt to model data in order to solve a problem. 
\begin{itemize}
    \item The \textbf{unsupervised learning} approach finds patterns/relationships/structure in data, but are not optimized to solve a particular predictive task.  
    \item The \textbf{supervised learning} approach aims to directly model the relationship between input and output variables, so that the output variables can be predicted accurately given the input.
\end{itemize}

\subsection{Regression}
Regression is one of the simplest supervised learning approaches to learn relationships between input variables (features) and output variables (predictions).

\subsubsection{Linear Regression}
Linear regression assumes a predictor of the form \[X\theta = y,\] where 
\begin{itemize}
    \item $X$ is the matrix of features (the data); it's the representation of data as a matrix associated with users and items,
    \item $\theta$ are the unknowns (which features are relevant); it somehow explains the relationship between the features and the labels we're trying to predict,
    \item $y$ is the vector of outputs (labels that we're trying to predict).
\end{itemize}

\begin{mdframed}[]
    (Motivation.) Height vs. Weight. 

    \bigskip 

    Suppose we're given a scattered plot, where the $x$-axis is the height and the $y$-axis is the weight. Can we find a line that approxiately fits the data? 

    \bigskip 

    We can model this relationship by using the classic equation \[y = mx + b.\] Here, $m$ is the slope and $b$ is the intercept. In our case here, we're trying to predict \[\text{weight} = m \cdot \text{height} + b.\] $m$ and $b$ are the unknowns, and we need to fit those from the data so that the line follows the data as accurately as possible. 

    \bigskip 

    If we can find such a line, then we can use it to make \textbf{predictions} (i.e., estimate a person's weight given their height).
\end{mdframed}


\begin{mdframed}[]
    (Motivation.) Height vs. Weight vs. Age. 

    \bigskip 

    We can generalize this to multiple dimensions! We can use the equation 
    \[\text{weight} = m_1 \cdot \text{height} + m_2 \cdot \text{age} + b.\] 
    In matrix form, this would be 
    \[y = \begin{bmatrix}
        m_1, m_2, b
    \end{bmatrix} \cdot \begin{bmatrix}
        \text{weight} \\ \text{age} \\ 1
    \end{bmatrix}.\]
    Here, we might have a two-dimensional graph with height, age, and weight. Then, instead of a line, we might have a plane. 
\end{mdframed}

\end{document}